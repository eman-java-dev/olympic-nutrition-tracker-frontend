<div class="container section">
  <h2>{{ t('nutrition.title') }}</h2>
  <p style="color:var(--muted)">{{ t('nutrition.help') }}</p>

  <form #f="ngForm" (ngSubmit)="save(f)" style="display:grid; grid-template-columns:repeat(6,1fr); gap:12px; margin:16px 0;">
    <input class="input" type="date" name="date" [(ngModel)]="model.date" required />
    <input class="input" type="number" name="calories" [(ngModel)]="model.calories" [placeholder]="t('nutrition.cal')" required />
    <input class="input" type="number" name="protein" [(ngModel)]="model.protein" [placeholder]="t('nutrition.p')" />
    <input class="input" type="number" name="carbs" [(ngModel)]="model.carbs" [placeholder]="t('nutrition.c')" />
    <input class="input" type="number" name="fat" [(ngModel)]="model.fat" [placeholder]="t('nutrition.f')" />
    <input class="input" name="notes" [(ngModel)]="model.notes" [placeholder]="t('nutrition.notes')" />
    <div class="actions" style="grid-column:1/-1">
      <button class="btn btn-primary" type="submit">{{ editingId() ? t('nutrition.update') : t('nutrition.add') }}</button>
      <button class="btn btn-ghost" type="button" *ngIf="editingId()" (click)="editingId.set(null); f.resetForm()">{{ t('nutrition.cancel') }}</button>
    </div>
  </form>

  <div class="card" style="margin-bottom:16px;">
    <div class="card-body">
      <span class="badge">{{ t('nutrition.summary') }}</span>
      <div style="display:flex; gap:16px; margin-top:8px;">
        <div>Calories: <b>{{ totalCalories }}</b></div>
        <div>P: <b>{{ totals.p }}g</b></div>
        <div>C: <b>{{ totals.c }}g</b></div>
        <div>F: <b>{{ totals.f }}g</b></div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <table class="table">
        <thead><tr><th>{{ t('nutrition.date') }}</th><th>{{ t('nutrition.cal') }}</th><th>P</th><th>C</th><th>F</th><th>{{ t('nutrition.notes') }}</th><th>Actions</th></tr></thead>
        <tbody>
          <tr *ngFor="let e of list()">
            <td>{{e.date}}</td><td>{{e.calories}}</td><td>{{e.protein}}</td><td>{{e.carbs}}</td><td>{{e.fat}}</td><td>{{e.notes || '—'}}</td>
            <td class="actions">
              <button class="btn btn-ghost" (click)="edit(e)">{{ t('nutrition.update') }}</button>
              <button class="btn btn-ghost" (click)="remove(e.id!)">Delete</button>
            </td>
          </tr>
          <tr *ngIf="!list()?.length"><td colspan="7" style="color:var(--muted)">—</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
